言語: [en](https://github.com/zero-plusplus/autohotkey-devtools/blob/main/editors/vscode/vscode-autohotkey-devtools/README.md) / ja

# ライセンス
> **重要: ライセンスの全文は[こちら(en)](https://github.com/zero-plusplus/autohotkey-devtools?tab=readme-ov-file#about-license).**

## 注意事項

インストールする前に利用者は以下のことに気を付けてください。

* **この拡張機能は未完成です。機能は少なく仕様も定まっていません。順次機能を追加していきますが、完成には今後10年以上かかることが予想されます**

* オープンソースライセンスではありません。つまり、ソースコードを他のプロジェクトに含めることはできません

* 使用は自己責任です。いかなる問題が発生しても責任を取りません。可能な限り問題を取り除く努力をしますが個人開発である以上限界がありますのでご了承ください

* 他の拡張機能との連携を保証するのは[vscode-autohotkey-debug](https://marketplace.visualstudio.com/items?itemName=zero-plusplus.vscode-autohotkey-debug)だけです

---

拡張機能開発者は上記に加えて[追加の注意事項](#追加の注意事項)にも気を付けてください。

# 概要

この拡張機能は個人的な問題を解決しつつ、AutoHotkey統合開発環境を実現することを目指して1人で開発されています。

vscode-autohotkey-debugと同じく新機能を追加することに重点を置いていますが、この時の失敗からリリース間隔を短くしつつ安定性を保てるように注意しながら開発を進めています。ただし、基礎部分の開発が進むまではリリース間隔が長くなることが予想されます。

現在は以下の機能がサポートされます。

* [シンタックスハイライト](#シンタックスハイライト)

# 貢献

ライセンス上の問題と個人的な問題によりプルリクエストは受け付けていません。
その代わりに[Issues](https://github.com/zero-plusplus/autohotkey-devtools/issues)および[Discussions](https://github.com/zero-plusplus/autohotkey-devtools/discussions)にて機能リクエストやバグ報告などを受け付けています。もし、日本語で報告したい場合はDiscussionsを利用してください。

私は利用者のフィードバックを重視しているため、基本的に翌日までに返事するようにしています。気楽にご利用ください。

# 利用可能な機能
## シンタックスハイライト

> **ヒント:** この機能はエディタおよびマークダウンのコードブロック、後述の[ドキュメントコメント](#ドキュメントコメント)でも有効です。

### 言語ID

以下の言語IDがサポートされており、AutoHotkey v1.1からv2.1までをサポートしています。

<table>
<tr>
  <th>言語ID</th>
  <th>拡張子</th>
  <th>説明</th>
</tr>
<tr>
  <td>autohotkey</td>
  <td>.ahk</td>
  <td>ソースコードを安定したバージョン(現在はv2.0)としてハイライトします。後述するように<a href="https://www.autohotkey.com/docs/v2/lib/_Requires.htm">#Requires</a>ディレクティブを使うことで任意のバージョンに切り替えることができます。</td>
</tr>
<tr>
  <td>autohotkeynext</td>
  <td>.ahknext</td>
  <td>ソースコードを開発中のバージョン(現在はv2.1)としてハイライトします。</td>
</tr>
<tr>
  <td>autohotkey2</td>
  <td>.ahk2</td>
  <td>ソースコードをv2としてハイライトします。</td>
</tr>
<tr>
  <td>autohotkeyl</td>
  <td>.ahkl</td>
  <td>
    ソースコードをv1.1としてハイライトします。<br />
    <br />
    <blockquote><b>
      注意: 利用者には影響ないと思われますが、開発時のデバッグ環境下において入力中にハイライトがちらつく問題が確認されています。これはv1.1の定義ファイルがv2と比べて10倍程度大きいことが原因だと思われます。利用者に問題が発生する場合は容量の大半を占めるコマンド文のハイライトパターンを簡略化したバージョンを提供するつもりです。
    </b></blockquote>
    <br />
    <blockquote>
      <b>ヒント:</b> <code>autohotkeyl</code>の最後は<code>L</code>です。<a href="https://www.autohotkey.com/docs/v2/v1-changes.htm">AutoHotkey v1.1がAutoHotkey_Lと呼ばれていた</a>ことが由来です。
    </blockquote>
  </td>
</tr>
</table>

settings.jsonの`files.associations`を設定することで任意の拡張子に言語IDを割り当てることができます。

例えばv1.1だけを利用している場合は以下のように割り当てるとよいでしょう。

```json
"files.associations": {
  "*.ahk": "autohotkeyl",
},
```

### 使用例

<code>autohotkey</code>言語IDを適用したソースコードでは[#Requires](https://www.autohotkey.com/docs/v2/lib/_Requires.htm)ディレクティブを使うことで任意のバージョンとしてハイライトさせることができます。今のところ`#Requires AutoHotkey vX.Y`のような表記のみをサポートしています。

> **重要: 以下の例は拡張機能ビューやマーケットプレイス上から確認できません。このプロジェクトは未完成であり、まだ画像を使って説明するような段階ではありません。**
> **この拡張機能をインストールした上で以下のソースコードを任意の`xxx.ahk`に貼り付けて確認してください。**

```
ToolTip, '#Requiresを省略した場合はv2.0として扱われます。これは関数呼び出し文としてハイライトされます'

#Requires AutoHotkey v2.1
import AHK

AHK.ToolTip('v2.1のimport文がハイライトされるようになります')

#Requires AutoHotkey v1.1

ToolTip, 関数呼び出し文ではなくコマンド文としてハイライトされます

; 以下のように引数によって変わる複雑なコマンド文も正確にハイライトできます(一部強調表示などは未完成)
Hotkey, ^+c, Label, On
Hotkey, If, expression
Hotkey, IfWinActive, ahk_id WinTitle
```

> **ヒント:** 上の例を試してもらうと`#Requires`ごとに指定したバージョンのハイライトが適用されることが確認できます。1つのソースコードに異なるバージョンがハイライトされても構文エラーにより実行できないため意味はないのですが、この拡張機能のシンタックスハイライトはマークダウンのコードブロックや後述のドキュメントコメント内でも利用できるため、学習用のメモには使えるかもしれません。

### 特殊な条件によるハイライト

本来は必要に応じてハイライトするセマンティックハイライトを使って実装すべきものですが、技術的な問題によりシンタックスハイライトにて先行導入しています。これはソースコードを解析するためのツールが作成されるまでの一時的な機能です。

#### 定数

`UPPER_SNAKE_CASE`のように大文字のアルファベットと`_`で構成された変数を定数としてハイライトします。実際に定数として機能するわけではありませんのでご注意ください。

これは将来的に削除され、ドキュメントコメントの`@const`タグで制御できるようにするつもりです。

#### 正規表現としてハイライト

`"i)^regexp$"`のように正規表現として扱える文字列を正規表現としてハイライトします。具体的には文字列が`)`から始まる、あるいは`im)`のように`)`の前に正規表現オプションが指定された場合です。

将来的にドキュメントコメントの`@type`タグなどで制御できるようにしますが、それまでの間に意図せず正規表現としてハイライトされてしまう場合は<code>"\`)string"</code>のように<code>\`)</code>のようにエスケープすることで回避する必要があります。

#### コマンド引数

コマンドおよびディレクティブの引数は以下のようにハイライトされます。

* `Gui, New`における`New`のようなサブコマンドはコマンド名と同じようにハイライトします
* `Gui, GuiName:New`における`GuiName:`のようなGui名はラベルと同じようにハイライトします
* `AutoTrim, On`における`On`のようなキーワードは文字列としてハイライトし、スタイルを太文字に変更します(一部未対応)
* `Hotkey, If, expression`や`WinGetText, output`のように、式あるいは変数を受け付ける引数は式としてハイライトします
* `% expression`はどの引数に対しても式としてハイライトします
* `%variable%`における`variable`は変数としてハイライトします
* 省略しなければならない引数に対して値を指定した場合は、エラー(既定のダークテーマであれば赤色)としてハイライトします
* 上記以外は文字列としてハイライトします。

上記のハイライトを実現するために、サブコマンドを含めた300近いパターンを用意しています。これによりv2と比べて定義ファイルが10倍ほどになっているため、入力中にちらつくなどの問題が発生する可能性があります。ただし、この問題は拡張機能開発時のデバッグ環境下でのみ発生しており、利用者には影響はないはずです

### ドキュメントコメント

`/**`または`;;`から始まるコメントはドキュメントコメントとしてハイライトされます。

ドキュメントコメント内ではマークダウンとjsdocのブロックタグおよびインラインタグがサポートされています。現在はハイライトのみがサポートされています。

> **注意: ドキュメントコメントの仕様は定まっておらず、jsdocとの互換性を保障するわけではありません。**

# 追加の注意事項

あなたが拡張機能開発者である場合は以下のことにも注意してください。

* この拡張機能は連携を保証していないため、連携が可能かのように説明しないでください。拡張機能パックに含んだり、他拡張機能から機能を参照するのも同じ理由でご遠慮ください

* 非推奨にマークした拡張機能の移行先にこの拡張機能を選ぶのは不適切です。個人により1から作成されているため、その他の拡張機能と互換性はありません

この拡張機能は個人的な目標を達成するために立ち上げられた私のプロジェクトの一部です。普遍的な問題だけを解決するプロジェクトではないため、意図的に1人で開発を行っています。そのため、利用者からのフィードバックという例外を除いて他の開発者と協力するつもりはありません。

私は多くのフィードバックを得るために多くの独自機能を計画しており、それによって得たフィードバックからさらに多くの独自機能を提供するという良い循環を期待して個人のツールを公開しています。

このプロジェクトの一部であるvscode-autohotkey-debugではMITライセンスを使っていましたが、ソースコード全体をフォークして他の拡張機能に取り込むことを提案されたことで容易に独自性が失われることに気が付きました。

独自性を失うことで私の拡張機能をインストールする動機が失われ、上記で説明した循環がうまく機能しなくなる上、活動に対するモチベーションを失うことにつながります。この問題を回避するために現在のような非寛容なライセンスを使うことにしました。

ご理解いただけると幸いです。
